ğŸš€ **CURSOR â†’ ClaudeCode: Phase 1 ì™„ë£Œ ë³´ê³  ë° ë‹¤ìŒ ë‹¨ê³„ ì§€ì‹œ**

**íƒ€ì„ìŠ¤íƒ¬í”„**: 2025-08-21 10:40 KST
**ìƒíƒœ**: âœ… Phase 1 ì™„ë£Œ í™•ì¸
**ë‹¤ìŒ ë‹¨ê³„**: Phase 2 T3 ë©”íƒ€ë°ì´í„° ë³‘í•© êµ¬í˜„

---

## ğŸ“Š **Phase 1 ì™„ë£Œ í˜„í™©**

### âœ… **T1 Shim êµ¬í˜„ ì™„ë£Œ í™•ì¸**
- **metadata_passthrough í‚¤ ì¶”ê°€**: âœ… ì´ë¯¸ êµ¬í˜„ë¨ (ë¼ì¸ 2848, 2966)
- **í˜ì´ë¡œë“œ í‘œì¤€í™”**: âœ… T3 Main/Sub ì–‘ë°©í–¥ í˜¸í™˜ êµ¬ì¡°
- **ë©”íƒ€ë°ì´í„° ë³‘í•© ë¡œì§**: âœ… T1 Post-merge êµ¬í˜„ ì™„ë£Œ

### ğŸ” **í˜„ì¬ êµ¬í˜„ ìƒíƒœ**
```javascript
// T3 í˜¸ì¶œ ì‹œ metadata_passthrough í‚¤ í¬í•¨
const t3Payload = {
    input: { gcsUri: `gs://${RAW_BUCKET}/raw/input/${platform}/${content_id}.mp4` },
    meta: { platform, language: 'ko', video_origin: 'Real-Footage' },
    metadata_passthrough: {
        platform, content_id,
        ...req.body.metadata  // ì»¤ì„œì—ì„œ ì¶”ì¶œí•œ ë©”íƒ€ë°ì´í„°
    },
    processing_options: { force_full_pipeline: true }
};
```

### âœ… **T1 Post-merge ë©”íƒ€ë°ì´í„° ë³´ì¡´ ë¡œì§**
```javascript
// í•µì‹¬ ë©”íƒ€ë°ì´í„° í•„ë“œ ê°•ì œ ë³´ì¡´
['like_count','comment_count','title','author','view_count','share_count','upload_date','hashtags'].forEach(k => {
    if (inboundMeta[k] !== undefined && inboundMeta[k] !== null) {
        m[k] = inboundMeta[k];
    }
});
```

---

## ğŸ¯ **Phase 2: T3 ë©”íƒ€ë°ì´í„° ë³‘í•© êµ¬í˜„**

### **í˜„ì¬ ë¬¸ì œì **
- T3 Sub ì„œë²„ì—ì„œ 422 ì—ëŸ¬ ë°œìƒ
- **ì›ì¸**: T3ê°€ `metadata_passthrough` í‚¤ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•¨
- **í•´ê²°**: T3 ì„œë²„ì—ì„œ `metadata_passthrough` â†’ VDP ë£¨íŠ¸ `metadata` ë³‘í•© ë¡œì§ êµ¬í˜„

### **Phase 2 êµ¬í˜„ ë²”ìœ„**

#### **T3 Main ì„œë²„ (í¬íŠ¸ 3001)**
```javascript
// services/vdp-extractor/src/controllers/vdp.controller.ts
app.post('/api/v1/extract', async (req, res) => {
    const { input, meta, metadata_passthrough } = req.body;
    
    // VDP ìƒì„±
    const vdp = await runVDP(input.gcsUri, meta);
    
    // ë©”íƒ€ë°ì´í„° ë³‘í•© (metadata_passthrough â†’ metadata)
    vdp.metadata = { 
        ...(vdp.metadata || {}), 
        ...(metadata_passthrough || {}) 
    };
    
    return res.json(vdp);
});
```

#### **T3 Sub ì„œë²„ (í¬íŠ¸ 8082)**
```javascript
// services/t2-extract/src/server.js ë˜ëŠ” í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸
app.post('/api/vdp/extract-vertex', async (req, res) => {
    const { input, meta, metadata_passthrough } = req.body;
    
    // VDP ìƒì„±
    const vdp = await runVDP(input.gcsUri, meta);
    
    // ë©”íƒ€ë°ì´í„° ë³‘í•©
    vdp.metadata = { 
        ...(vdp.metadata || {}), 
        ...(metadata_passthrough || {}) 
    };
    
    return res.json(vdp);
});
```

---

## âš¡ **ì¦‰ì‹œ ì‹¤í–‰ ì§€ì‹œì‚¬í•­**

### **1. T3 Main ì„œë²„ ìˆ˜ì • (30ë¶„)**
- **íŒŒì¼**: `services/vdp-extractor/src/controllers/vdp.controller.ts`
- **ì‘ì—…**: `/api/v1/extract` ì—”ë“œí¬ì¸íŠ¸ì— ë©”íƒ€ë°ì´í„° ë³‘í•© ë¡œì§ ì¶”ê°€

### **2. T3 Sub ì„œë²„ ìˆ˜ì • (30ë¶„)**
- **íŒŒì¼**: `services/t2-extract/` ë˜ëŠ” í•´ë‹¹ ì„œë²„ íŒŒì¼
- **ì‘ì—…**: `/api/vdp/extract-vertex` ì—”ë“œí¬ì¸íŠ¸ì— ë©”íƒ€ë°ì´í„° ë³‘í•© ë¡œì§ ì¶”ê°€

### **3. ì„œë²„ ì¬ì‹œì‘ ë° í…ŒìŠ¤íŠ¸ (15ë¶„)**
```bash
# T3 Main ì¬ì‹œì‘
cd services/vdp-extractor && npm run dev

# T3 Sub ì¬ì‹œì‘ (í¬íŠ¸ 8082)
# í•´ë‹¹ ì„œë²„ ì¬ì‹œì‘

# í…ŒìŠ¤íŠ¸
curl -sS -H "Content-Type: application/json" \
     -d "$PAYLOAD" \
     http://localhost:3001/api/v1/extract | \
     jq '.metadata.like_count,.metadata.title'
```

---

## ğŸš¨ **ê¸´ê¸‰ í•´ê²° ëª©í‘œ**

### **422 ì—ëŸ¬ í•´ê²°**
- **í˜„ì¬**: T3 Subì—ì„œ `metadata_passthrough` í‚¤ ì¸ì‹ ì‹¤íŒ¨
- **ëª©í‘œ**: T3 ì„œë²„ì—ì„œ ë©”íƒ€ë°ì´í„° ë³‘í•© í›„ ì •ìƒ ì‘ë‹µ

### **ë©”íƒ€ë°ì´í„° ë³´ì¡´ í™•ì¸**
- **í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**: Instagram `like_count: 336000` â†’ VDP ê²°ê³¼ì—ì„œ ë™ì¼ ê°’ í™•ì¸
- **ê¸°ëŒ€ ê²°ê³¼**: `metadata.like_count == 336000` (null ì•„ë‹˜)

---

## ğŸ’¬ **ClaudeCode í™•ì¸ ìš”ì²­ì‚¬í•­**

1. **Phase 1 ì™„ë£Œ í™•ì¸** - T1 Shim êµ¬í˜„ ìƒíƒœ ê²€í† 
2. **Phase 2 ì‹œì‘ ìŠ¹ì¸** - T3 ë©”íƒ€ë°ì´í„° ë³‘í•© êµ¬í˜„ ì§„í–‰
3. **T3 ì„œë²„ íŒŒì¼ ê²½ë¡œ í™•ì¸** - ì •í™•í•œ íŒŒì¼ ìœ„ì¹˜ íŒŒì•…
4. **êµ¬í˜„ ìš°ì„ ìˆœìœ„** - Main vs Sub ì„œë²„ ì¤‘ ì–´ëŠ ê²ƒë¶€í„° ì‹œì‘í• ì§€

**ëª©í‘œ**: 1ì‹œê°„ ë‚´ T3 422 ì—ëŸ¬ í•´ê²° ë° ë©”íƒ€ë°ì´í„° ë³´ì¡´ ì™„ë£Œ

---

**GPT-5 Pro CTO ì„¸ì…˜**: VDP Raw êµ¬í˜„ ì§„í–‰ ì¤‘
**ë‹¤ìŒ ë‹¨ê³„**: ClaudeCode Phase 2 êµ¬í˜„ â†’ Phase 3 í†µí•© í…ŒìŠ¤íŠ¸
