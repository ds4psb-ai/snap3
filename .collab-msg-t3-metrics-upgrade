# ğŸ“¨ T3 - ë©”íŠ¸ë¦­ ì‹œìŠ¤í…œ ë²”ìš© í™•ì¥

**Priority**: CRITICAL  
**Action**: Universal-Metrics-Upgrade  
**Correlation-ID**: T3-METRICS-UPGRADE-001  
**Timeline**: T+0~15ë¶„ ë³‘ë ¬ ì‹¤í–‰

---

## ğŸ¯ **T3 VDP Terminal ëª…ë ¹ì–´ (ì¦‰ì‹œ ì‹¤í–‰)**

### **í˜„ì¬ ìƒíƒœ í™•ì¸**
```bash
cd /Users/ted/snap3/services/t2-extract

# 1. í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
ps aux | grep -E "(circuit-breaker|p95)" | grep -v grep
echo "âœ… í˜„ì¬ ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ"

# 2. í˜„ì¬ SLO ìƒíƒœ í™•ì¸
curl -s http://localhost:8080/api/circuit-breaker/status | jq '{
    slo_status: (.performance_metrics.success_rate | rtrimstr("%") | tonumber > 90),
    p95_within_slo: (.performance_metrics.avg_response_time | rtrimstr("ms") | tonumber < 500),
    consensus_ready: (.state.state == "CLOSED")
}'
```

### **Phase 1: ë²”ìš© ë©”íŠ¸ë¦­ í™•ì¥**
```bash
# 3. ë²”ìš© ë©”íŠ¸ë¦­ ìˆ˜ì§‘ê¸° ìƒì„±
cat > universal-metrics-collector.sh <<'BASH'
#!/bin/bash
# ë²”ìš© ì¬ê·€ê°œì„ ì„ ìœ„í•œ í™•ì¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ê¸°
set -euo pipefail

CORRELATION_ID="T3-UNIVERSAL-$(date +%s)"
METRICS_DIR="../../../logs/universal"
mkdir -p "$METRICS_DIR"

collect_universal_metrics() {
    local context="$1"
    local timestamp=$(date +%s)
    
    # Circuit Breaker ìƒíƒœ
    cb_status=$(curl -s http://localhost:8080/api/circuit-breaker/status 2>/dev/null || echo '{}')
    
    # P95 ë©”íŠ¸ë¦­
    p95_data=$(cat p95-results.json 2>/dev/null || echo '{}')
    
    # í†µí•© ë©”íŠ¸ë¦­ ìƒì„±
    jq -n \
        --arg ts "$timestamp" \
        --arg ctx "$context" \
        --arg corr "$CORRELATION_ID" \
        --argjson cb "$cb_status" \
        --argjson p95 "$p95_data" \
        '{
            timestamp: $ts,
            context: $ctx,
            correlation_id: $corr,
            circuit_breaker: $cb,
            p95_metrics: $p95,
            collection_time: (now | todate)
        }' >> "$METRICS_DIR/universal-metrics-$(date +%Y%m%d).jsonl"
}

# ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‹¤í–‰
collect_universal_metrics "architecture"
echo "âœ… [T3] ë²”ìš© ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì™„ë£Œ"
BASH

chmod +x universal-metrics-collector.sh

# 4. ìš´ì˜ ìƒíƒœ ì ê²€
./operational-check.sh 2>/dev/null || echo "ğŸ” operational-check.sh ì‹¤í–‰ í™•ì¸"
```

### **Phase 1 ì™„ë£Œ ì‹ í˜¸**
```bash
# T3 ë²”ìš© ì¤€ë¹„ ì™„ë£Œ í‘œì‹œ
touch .t3-universal-ready
echo "T3-UNIVERSAL-METRICS-UPGRADE-COMPLETE-$(date +%s)" > .t3-universal-ready

# í˜„ì¬ ì„±ëŠ¥ ìš”ì•½
echo "ğŸ“Š [T3] í˜„ì¬ ì„±ëŠ¥ ìƒíƒœ:"
curl -s http://localhost:8080/api/circuit-breaker/status | jq '{
    state: .state.state,
    success_rate: .performance_metrics.success_rate,
    avg_response: .performance_metrics.avg_response_time
}'
```

---

**T3 ì‹¤í–‰ ëª…ë ¹ì–´**: `cd /Users/ted/snap3/services/t2-extract && cat ../../.collab-msg-t3-metrics-upgrade`