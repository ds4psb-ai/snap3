name: Create Pinned Context

on:
  push:
    branches: [ main ]
    paths:
      - 'src/**'
      - 'scripts/**'
      - 'docs/**'
      - '.github/**'
      - '*.md'
  workflow_dispatch:
    inputs:
      force_update:
        description: 'Force update pinned context'
        required: false
        default: 'false'
        type: boolean

jobs:
  create-pinned-context:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
      discussions: write

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 10

      - name: Generate Comprehensive Context
        run: |
          echo "# ğŸ¯ VDP Pipeline - ì‚¼ê°í¸ëŒ€ ì˜êµ¬ ì»¨í…ìŠ¤íŠ¸" > pinned_context.md
          echo "" >> pinned_context.md
          echo "**ğŸ“… Last Updated**: $(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> pinned_context.md
          echo "**ğŸ”„ Auto-Updated**: Every main branch push" >> pinned_context.md
          echo "**ğŸ“Œ Purpose**: ì˜êµ¬ì ì¸ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ - GPT-5 Pro â†” ClaudeCode â†” Cursor ì‚¼ê°í¸ëŒ€" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # í•µì‹¬ í”„ë¡œì íŠ¸ ì •ë³´
          echo "## ğŸ  í”„ë¡œì íŠ¸ ê°œìš”" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ“‹ ê¸°ë³¸ ì •ë³´" >> pinned_context.md
          echo "- **í”„ë¡œì íŠ¸**: VDP RAW Generation Pipeline" >> pinned_context.md
          echo "- **ëª©ì **: YouTube, Instagram, TikTok ì½˜í…ì¸  â†’ VDP(Video Data Package) ìƒì„±" >> pinned_context.md
          echo "- **ì•„í‚¤í…ì²˜**: 4í„°ë¯¸ë„ + 2UI + Platform-segmented GCS" >> pinned_context.md
          echo "- **í•µì‹¬ ë²„í‚·**: \`tough-variety-raw-central1\` (us-central1)" >> pinned_context.md
          echo "- **Working Directory**: \`~/snap3\`" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ìµœê·¼ 5ì»¤ë°‹ ìš”ì•½
          echo "### ğŸ“‹ ìµœê·¼ ë³€ê²½ì‚¬í•­" >> pinned_context.md
          echo '```' >> pinned_context.md
          bash scripts/generate_summary.sh >> pinned_context.md
          echo '```' >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ì‚¼ê°í¸ëŒ€ ì—­í•  ë¶„ë‹´
          echo "## ğŸ¯ ì‚¼ê°í¸ëŒ€ ì—­í•  ë¶„ë‹´" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ§  GPT-5 Pro (HEAD ì½”ì¹˜)" >> pinned_context.md
          echo "- **ì—­í• **: ì „ëµ ìˆ˜ë¦½, ì˜ì‚¬ê²°ì •, ì‘ì—… ì¡°ìœ¨" >> pinned_context.md
          echo "- **ë°©ë²•**: ì´ ì»¨í…ìŠ¤íŠ¸ ì „ì²´ë¥¼ ìƒˆ ì±„íŒ…ì— ë³µì‚¬ â†’ \`Use this for triangular collaboration\`" >> pinned_context.md
          echo "- **ì›Œí¬í”Œë¡œìš°**: [ì‚¼ê°í¸ëŒ€ ê°€ì´ë“œ](https://github.com/${{ github.repository }}/blob/main/docs/GPT5_CLAUDECODE_CURSOR_TRIANGULAR_WORKFLOW.md)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### âš™ï¸ ClaudeCode (MAIN êµ¬í˜„)" >> pinned_context.md
          echo "- **ì—­í• **: ë°±ì—”ë“œ ì„œë¹„ìŠ¤, API, ë°ì´í„° ì²˜ë¦¬, 4í„°ë¯¸ë„ ìš´ì˜" >> pinned_context.md
          echo "- **íŠ¹í™”**: VDP ì¶”ì¶œ, GCS ì²˜ë¦¬, BigQuery ì ì¬, ì›Œì»¤ ì‹œìŠ¤í…œ" >> pinned_context.md
          echo "- **í„°ë¯¸ë„**: Main T1(~/snap3), Jobs T2(~/snap3-jobs), T2VDP T3(~/snap3/services/t2-extract), Storage T4(~/snap3-storage)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ¨ Cursor (SUB êµ¬í˜„)" >> pinned_context.md
          echo "- **ì—­í• **: í”„ë¡ íŠ¸ì—”ë“œ, UI/UX, ì»´í¬ë„ŒíŠ¸, í´ë¼ì´ì–¸íŠ¸ ë¡œì§" >> pinned_context.md
          echo "- **íŠ¹í™”**: Next.js ê°œë°œ, shadcn-ui, Instagram/TikTok ë©”íƒ€ë°ì´í„° ì¶”ì¶œê¸°" >> pinned_context.md
          echo "- **ì„œë²„**: npm run dev (3000), node simple-web-server.js (8080)" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # í•µì‹¬ ì‹œìŠ¤í…œ ìƒíƒœ
          echo "## ğŸ–¥ï¸ ì‹œìŠ¤í…œ êµ¬ì¡° & ìƒíƒœ" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸŒ UI ì„œë²„ (2ê°œ)" >> pinned_context.md
          echo "- **ì¸ì œìŠ¤íŠ¸ UI**: http://localhost:8080 (\`node simple-web-server.js\`)" >> pinned_context.md
          echo "  - ìš©ë„: YouTube/Instagram/TikTok URL ì…ë ¥ ë° ì²˜ë¦¬" >> pinned_context.md
          echo "  - API: POST /api/vdp/extract-vertex, POST /api/normalize-url" >> pinned_context.md
          echo "- **ë©”ì¸ UI**: http://localhost:3000 (\`npm run dev\`)" >> pinned_context.md
          echo "  - ìš©ë„: ë¹„ë””ì˜¤ ìƒì„± íŒŒì´í”„ë¼ì¸, Instagram ì¶”ì¶œê¸°" >> pinned_context.md
          echo "  - íŠ¹ë³„ ê¸°ëŠ¥: /instagram-extractor (Production Ready)" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # í™˜ê²½ë³€ìˆ˜ ìƒíƒœ
          echo "### âš™ï¸ í•µì‹¬ í™˜ê²½ë³€ìˆ˜" >> pinned_context.md
          echo '```bash' >> pinned_context.md
          echo "PROJECT_ID=\"tough-variety-466003-c5\"" >> pinned_context.md
          echo "REGION=\"us-central1\"" >> pinned_context.md
          echo "RAW_BUCKET=\"tough-variety-raw-central1\"" >> pinned_context.md
          echo "PLATFORM_SEGMENTED_PATH=true" >> pinned_context.md
          echo '```' >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ìµœê·¼ ì™„ì„± ê¸°ëŠ¥
          echo "## âœ… ìµœê·¼ ì™„ì„± ê¸°ëŠ¥ (Production Ready)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### 1. Instagram & TikTok ë©”íƒ€ë°ì´í„° ì¶”ì¶œê¸°" >> pinned_context.md
          echo "- **ìœ„ì¹˜**: http://localhost:3000/instagram-extractor" >> pinned_context.md
          echo "- **ê¸°ëŠ¥**: 7ë‹¨ê³„ ì¶”ì¶œ ì „ëµ, ì‹¤ì œ ë°ì´í„° 100%, ì›Œí„°ë§ˆí¬ ì—†ëŠ” ë‹¤ìš´ë¡œë“œ" >> pinned_context.md
          echo "- **API**: /api/instagram/metadata, /api/tiktok/metadata" >> pinned_context.md
          echo "- **ë¬¸ì„œ**: [ì™„ì „í•œ ê¸°ìˆ  ë¬¸ì„œ](https://github.com/${{ github.repository }}/blob/main/INSTAGRAM_TIKTOK_METADATA_EXTRACTOR.md)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### 2. GPT-5â†”ClaudeCodeâ†”Cursor ì‚¼ê°í¸ëŒ€ ì›Œí¬í”Œë¡œìš°" >> pinned_context.md
          echo "- **GitHub Actions**: ìë™ ì»¨í…ìŠ¤íŠ¸ ìƒì„± (PR/ì»¤ë°‹ë§ˆë‹¤)" >> pinned_context.md
          echo "- **ë¡œì»¬ ìŠ¤í¬ë¦½íŠ¸**: generate_summary.sh, generate_cursor_context.sh" >> pinned_context.md
          echo "- **ë¬¸ì„œ**: [ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ](https://github.com/${{ github.repository }}/blob/main/docs/GPT5_CLAUDECODE_CURSOR_TRIANGULAR_WORKFLOW.md)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### 3. VDP RAW Generation Pipeline" >> pinned_context.md
          echo "- **í”Œë«í¼**: YouTube(ìë™), Instagram(ì¡°ê±´ë¶€), TikTok(ì¡°ê±´ë¶€)" >> pinned_context.md
          echo "- **ì²˜ë¦¬**: URL â†’ content_id â†’ VDP RAW + Hook Genome â†’ BigQuery ì ì¬" >> pinned_context.md
          echo "- **ê²€ì¦**: AJV ìŠ¤í‚¤ë§ˆ, Hook gates (â‰¤3s, â‰¥0.70), Evidence Pack v2.0" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥í•œ ì‘ì—…ë“¤
          echo "## ğŸš€ ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥í•œ ì‘ì—…ë“¤" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ¯ ìš°ì„ ìˆœìœ„ 1: Instagram/TikTok ì¶”ì¶œê¸° VDP í†µí•©" >> pinned_context.md
          echo "- **ëª©í‘œ**: ì¸ì œìŠ¤íŠ¸ UIì—ì„œ URL ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ ë©”íƒ€ë°ì´í„° ì¶”ì¶œí•´ì„œ í¼ ì±„ìš°ê¸°" >> pinned_context.md
          echo "- **ëŒ€ìƒ íŒŒì¼**: web/scripts/url-auto-fill.js + ìƒˆë¡œìš´ í†µí•© ë¡œì§" >> pinned_context.md
          echo "- **ì˜ˆìƒ íš¨ê³¼**: ì‚¬ìš©ì ì…ë ¥ ì‹œê°„ 80% ë‹¨ì¶•" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ¯ ìš°ì„ ìˆœìœ„ 2: UI/UX í†µí•© ê°œì„ " >> pinned_context.md
          echo "- **ëª©í‘œ**: 2ê°œ UI(3000/8080) ê°„ ì¼ê´€ì„± ìˆëŠ” ë””ìì¸" >> pinned_context.md
          echo "- **ëŒ€ìƒ**: shadcn-ui ì»´í¬ë„ŒíŠ¸ í‘œì¤€í™”, ë°˜ì‘í˜• ë””ìì¸" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ¯ ìš°ì„ ìˆœìœ„ 3: ì„±ëŠ¥ ìµœì í™”" >> pinned_context.md
          echo "- **ëª©í‘œ**: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ì†ë„ ê°œì„ , ìºì‹± ì‹œìŠ¤í…œ" >> pinned_context.md
          echo "- **ëŒ€ìƒ**: API ì‘ë‹µ ì‹œê°„, í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ìµœì í™”" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # í„°ë¯¸ë„ ëª…ë ¹ì–´ ì°¸ê³ 
          echo "## ğŸ–¥ï¸ í•µì‹¬ ëª…ë ¹ì–´ ì°¸ê³ " >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ClaudeCode í„°ë¯¸ë„ ëª…ë ¹ì–´" >> pinned_context.md
          echo '```bash' >> pinned_context.md
          echo "# Main T1 (~/snap3)" >> pinned_context.md
          echo "cd ~/snap3 && scripts/generate_summary.sh" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# Jobs T2 (~/snap3-jobs)" >> pinned_context.md
          echo "cd ~/snap3-jobs && ./worker-ingest-v2.sh --health" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# T2VDP T3 (~/snap3/services/t2-extract)" >> pinned_context.md
          echo "cd ~/snap3/services/t2-extract && ./run-all-checks.sh" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# Storage T4 (~/snap3-storage)" >> pinned_context.md
          echo "cd ~/snap3-storage && ./scripts/quick-validation.sh" >> pinned_context.md
          echo '```' >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### Cursor ëª…ë ¹ì–´" >> pinned_context.md
          echo '```bash' >> pinned_context.md
          echo "# ë©”ì¸ UI ê°œë°œ ì„œë²„" >> pinned_context.md
          echo "npm run dev  # http://localhost:3000" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# ì¸ì œìŠ¤íŠ¸ UI ì„œë²„" >> pinned_context.md
          echo "node simple-web-server.js  # http://localhost:8080" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# í…ŒìŠ¤íŠ¸ ë° ê²€ì¦" >> pinned_context.md
          echo "npm test" >> pinned_context.md
          echo "curl http://localhost:8080/api/health" >> pinned_context.md
          echo "curl http://localhost:3000/api/instagram/metadata" >> pinned_context.md
          echo '```' >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ê°€ì´ë“œ
          echo "## ğŸ”„ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ê°€ì´ë“œ" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ìë™ ì—…ë°ì´íŠ¸" >> pinned_context.md
          echo "- **íŠ¸ë¦¬ê±°**: main ë¸Œëœì¹˜ push, PR ìƒì„±" >> pinned_context.md
          echo "- **ê²°ê³¼**: ì´ ì´ìŠˆê°€ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨" >> pinned_context.md
          echo "- **í™•ì¸**: [Actions íƒ­](https://github.com/${{ github.repository }}/actions)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ìˆ˜ë™ ì—…ë°ì´íŠ¸" >> pinned_context.md
          echo '```bash' >> pinned_context.md
          echo "# ClaudeCode ì»¨í…ìŠ¤íŠ¸" >> pinned_context.md
          echo "./scripts/generate_summary.sh" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# Cursor ì»¨í…ìŠ¤íŠ¸" >> pinned_context.md
          echo "./scripts/generate_cursor_context.sh --include-files" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "# GPT-5 Pro ì»¨í…ìŠ¤íŠ¸" >> pinned_context.md
          echo "./scripts/generate_context_for_gpt5.sh --include-files --include-diff" >> pinned_context.md
          echo '```' >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ì¤‘ìš” ì œì•½ì‚¬í•­
          echo "## ğŸš¨ ì¤‘ìš” ì œì•½ì‚¬í•­ (ì ˆëŒ€ ì¤€ìˆ˜)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ì¸í”„ë¼ ì •ì±…" >> pinned_context.md
          echo "- **ë²„í‚·**: tough-variety-raw-central1 ONLY (ë‹¤ë¥¸ ë²„í‚· ì‚¬ìš© ê¸ˆì§€)" >> pinned_context.md
          echo "- **ë¦¬ì „**: us-central1 í†µì¼ (cross-region ê¸ˆì§€)" >> pinned_context.md
          echo "- **í”Œë«í¼ ì„¸ê·¸ë¨¼íŠ¸**: gs://bucket/raw/vdp/{platform}/ êµ¬ì¡° í•„ìˆ˜" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### API ì •ì±…" >> pinned_context.md
          echo "- **JSON-only**: FormData/multipart ì™„ì „ ê¸ˆì§€" >> pinned_context.md
          echo "- **Content_ID**: ëª¨ë“  ì¸ì œìŠ¤íŠ¸ ìš”ì²­ì— í•„ìˆ˜" >> pinned_context.md
          echo "- **Content_Key**: platform:content_id í˜•ì‹ìœ¼ë¡œ ê¸€ë¡œë²Œ ìœ ë‹ˆí¬" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### UI êµ¬ë¶„" >> pinned_context.md
          echo "- **8080 = ì¸ì œìŠ¤íŠ¸ UI**: YouTube/Instagram/TikTok ì…ë ¥ ì²˜ë¦¬" >> pinned_context.md
          echo "- **3000 = ë©”ì¸ UI**: ë¹„ë””ì˜¤ ìƒì„± íŒŒì´í”„ë¼ì¸ + ë©”íƒ€ë°ì´í„° ì¶”ì¶œê¸°" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # ë§í¬ ëª¨ìŒ
          echo "## ğŸ”— í•µì‹¬ ë§í¬ ëª¨ìŒ" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ“š ë¬¸ì„œ" >> pinned_context.md
          echo "- [ì‚¼ê°í¸ëŒ€ ì›Œí¬í”Œë¡œìš°](https://github.com/${{ github.repository }}/blob/main/docs/GPT5_CLAUDECODE_CURSOR_TRIANGULAR_WORKFLOW.md)" >> pinned_context.md
          echo "- [Cursor í†µí•© ê°€ì´ë“œ](https://github.com/${{ github.repository }}/blob/main/docs/CURSOR_TRIANGULAR_INTEGRATION.md)" >> pinned_context.md
          echo "- [ì»¨í…ìŠ¤íŠ¸ ì‹œìŠ¤í…œ ê°€ì´ë“œ](https://github.com/${{ github.repository }}/blob/main/docs/CONTEXT_SYSTEM_GUIDE.md)" >> pinned_context.md
          echo "- [Instagram/TikTok ì¶”ì¶œê¸°](https://github.com/${{ github.repository }}/blob/main/INSTAGRAM_TIKTOK_METADATA_EXTRACTOR.md)" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "### ğŸ”§ ê°œë°œ" >> pinned_context.md
          echo "- [Repository](https://github.com/${{ github.repository }})" >> pinned_context.md
          echo "- [Latest Commit](https://github.com/${{ github.repository }}/commit/${{ github.sha }})" >> pinned_context.md
          echo "- [Actions](https://github.com/${{ github.repository }}/actions)" >> pinned_context.md
          echo "- [Issues](https://github.com/${{ github.repository }}/issues)" >> pinned_context.md
          echo "" >> pinned_context.md
          
          # í‘¸í„°
          echo "---" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "**ğŸ¯ ì‚¬ìš©ë²•**: ì´ ì´ìŠˆ ì „ì²´ë¥¼ ìƒˆë¡œìš´ GPT-5 Pro ì±„íŒ…ì— ë³µì‚¬ â†’ \`Use this context for ClaudeCode â†” Cursor triangular collaboration\` ì¶”ê°€ â†’ ì¦‰ì‹œ ì‚¼ê°í¸ëŒ€ í˜‘ì—… ì‹œì‘!" >> pinned_context.md
          echo "" >> pinned_context.md
          echo "**ğŸ”„ ìë™ ì—…ë°ì´íŠ¸**: main ë¸Œëœì¹˜ ë³€ê²½ë§ˆë‹¤ ìë™ìœ¼ë¡œ ì´ ì»¨í…ìŠ¤íŠ¸ê°€ ê°±ì‹ ë©ë‹ˆë‹¤." >> pinned_context.md
          echo "" >> pinned_context.md
          echo "*ğŸ¤– Auto-generated by [Create Pinned Context Workflow](https://github.com/${{ github.repository }}/blob/main/.github/workflows/create-pinned-context.yml) â€¢ Last updated: $(date)*" >> pinned_context.md

      - name: Find or Create Pinned Issue
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const fs = require('fs');
            const body = fs.readFileSync('pinned_context.md', 'utf8');
            const title = 'ğŸ¯ VDP Pipeline - ì‚¼ê°í¸ëŒ€ ì˜êµ¬ ì»¨í…ìŠ¤íŠ¸';
            
            try {
              // ê¸°ì¡´ í•€ ì´ìŠˆ ì°¾ê¸°
              const issues = await github.rest.issues.listForRepo({
                owner: context.repo.owner,
                repo: context.repo.repo,
                labels: 'pinned-context,triangular-workflow',
                state: 'open'
              });
              
              let existingIssue = null;
              for (const issue of issues.data) {
                if (issue.title.includes('ì‚¼ê°í¸ëŒ€ ì˜êµ¬ ì»¨í…ìŠ¤íŠ¸')) {
                  existingIssue = issue;
                  break;
                }
              }
              
              if (existingIssue) {
                // ê¸°ì¡´ ì´ìŠˆ ì—…ë°ì´íŠ¸
                await github.rest.issues.update({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: existingIssue.number,
                  title: title,
                  body: body
                });
                
                console.log(`âœ… Updated existing pinned issue #${existingIssue.number}`);
                console.log(`ğŸ”— Issue URL: ${existingIssue.html_url}`);
                
                // Pin the issue (GitHub API doesn't have direct pin support, but we can add a label)
                await github.rest.issues.addLabels({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: existingIssue.number,
                  labels: ['ğŸ“Œ PINNED', 'triangular-workflow', 'context', 'GPT-5', 'ClaudeCode', 'Cursor']
                });
                
                core.setOutput('issue_url', existingIssue.html_url);
                core.setOutput('issue_number', existingIssue.number);
                core.setOutput('action', 'updated');
                
              } else {
                // ìƒˆ ì´ìŠˆ ìƒì„±
                const newIssue = await github.rest.issues.create({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  title: title,
                  body: body,
                  labels: ['ğŸ“Œ PINNED', 'triangular-workflow', 'context', 'GPT-5', 'ClaudeCode', 'Cursor']
                });
                
                console.log(`âœ… Created new pinned issue #${newIssue.data.number}`);
                console.log(`ğŸ”— Issue URL: ${newIssue.data.html_url}`);
                
                core.setOutput('issue_url', newIssue.data.html_url);
                core.setOutput('issue_number', newIssue.data.number);
                core.setOutput('action', 'created');
              }
              
            } catch (error) {
              console.log('âŒ Failed to create/update pinned issue:', error.message);
              throw error;
            }

      - name: Create Cursor Quick Access Comment
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issueNumber = '${{ steps.create-pinned-issue.outputs.issue_number }}' || 
                               core.getInput('issue_number');
            
            if (!issueNumber) {
              console.log('âš ï¸ No issue number available, skipping comment creation');
              return;
            }
            
            const cursorQuickStart = `## ğŸš€ Cursor Quick Start

### ì¦‰ì‹œ ì‹œì‘í•˜ê¸°
1. **ì´ ì´ìŠˆ ì „ì²´ë¥¼ Cursor ì±„íŒ…ì— ë³µì‚¬**
2. **ì¶”ê°€ ë©”ì‹œì§€**: \`Cursor, ì‚¼ê°í¸ëŒ€ì— í•©ë¥˜í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ ë‹´ë‹¹í•´ì£¼ì„¸ìš”\`
3. **í™•ì¸**: ì•„ë˜ ëª…ë ¹ì–´ë“¤ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸

### ğŸ–¥ï¸ Cursor ì „ìš© ëª…ë ¹ì–´
\`\`\`bash
# ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev  # http://localhost:3000

# ì¸ì œìŠ¤íŠ¸ UI ì‹œì‘  
node simple-web-server.js  # http://localhost:8080

# Instagram ì¶”ì¶œê¸° í…ŒìŠ¤íŠ¸
open http://localhost:3000/instagram-extractor

# í—¬ìŠ¤ ì²´í¬
curl http://localhost:8080/api/health
\`\`\`

### ğŸ¯ Cursor ìš°ì„  ì‘ì—…
- **Instagram/TikTok ì¶”ì¶œê¸° VDP í†µí•©**
- **UI/UX ì¼ê´€ì„± ê°œì„ **
- **shadcn-ui ì»´í¬ë„ŒíŠ¸ ìµœì í™”**

---
*ğŸ¤– Auto-generated Cursor quick start guide*`;

            try {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: parseInt(issueNumber),
                body: cursorQuickStart
              });
              
              console.log('âœ… Added Cursor quick start comment');
              
            } catch (error) {
              console.log('âš ï¸ Failed to add Cursor comment:', error.message);
            }

      - name: Upload Pinned Context Artifact
        uses: actions/upload-artifact@v4
        with:
          name: pinned-context-${{ github.sha }}
          path: pinned_context.md
          retention-days: 90

      - name: Summary
        run: |
          echo "âœ… Pinned Context System Ready!"
          echo ""
          echo "ğŸ”— Issue URL: ${{ steps.create-pinned-issue.outputs.issue_url }}"
          echo "ğŸ“Œ Issue Number: #${{ steps.create-pinned-issue.outputs.issue_number }}"
          echo "ğŸ¯ Action: ${{ steps.create-pinned-issue.outputs.action }}"
          echo ""
          echo "ğŸ“‹ Usage:"
          echo "1. Share issue URL with team members"
          echo "2. Copy entire issue content to new GPT-5 chat"
          echo "3. Add: 'Use this context for triangular collaboration'"
          echo "4. Start collaborating immediately!"