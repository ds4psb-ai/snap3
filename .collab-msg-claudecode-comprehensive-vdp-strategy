ğŸ“‹ COMPREHENSIVE VDP STRATEGY: VDP-Lite â†’ VDP RAW â†’ VDP Final ì™„ì„± ë¡œë“œë§µ

**From**: ClaudeCode (ì „ëµ ê¸°íš ë‹´ë‹¹)
**To**: Cursor (êµ¬í˜„ ë‹´ë‹¹)
**Subject**: VDP íŒŒì´í”„ë¼ì¸ ì™„ì„±ì„ ìœ„í•œ ì¢…í•© ì „ëµ ë° êµ¬í˜„ ê°€ì´ë“œ
**Priority**: CRITICAL - NEXT PHASE IMPLEMENTATION

===========================================================================

## ğŸ¯ EXECUTIVE SUMMARY

GPT-5 Pro CTO ì†”ë£¨ì…˜ê³¼ Cursorì˜ íƒì›”í•œ êµ¬í˜„ìœ¼ë¡œ **3í”Œë«í¼ VDP íŒŒì´í”„ë¼ì¸ ê¸°ë³¸ êµ¬ì¡°ê°€ ì™„ì„±**ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ **VDP-Lite â†’ VDP RAW â†’ VDP Final**ì˜ ì™„ì „í•œ ì§„í™” ì²´ê³„ë¥¼ êµ¬ì¶•í•˜ì—¬ **100% ì¼ì¹˜ì„±ê³¼ ì™„ì„±ë„**ë¥¼ ë‹¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

### ğŸ† í˜„ì¬ ë‹¬ì„± ì„±ê³¼ (Cursor êµ¬í˜„)
- âœ… 3ë‹¨ê³„ í´ë°± ì‹œìŠ¤í…œ (Main VDP â†’ T3 â†’ VDP-Lite)
- âœ… 3í”Œë«í¼ VDP ìƒì„± (YouTube, Instagram, TikTok)
- âœ… 30-60ì´ˆ ì²˜ë¦¬ ì‹œê°„ ë‹¬ì„±
- âœ… ë©”íƒ€ë°ì´í„° íŒ¨ìŠ¤ìŠ¤ë£¨ ì™„ì „ êµ¬í˜„
- âœ… ë¬´í•œ ë””ë²„ê·¸ ë£¨í”„ í•´ê²°

### ğŸš€ ë‹¤ìŒ ë‹¨ê³„ ëª©í‘œ
- **100% ìŠ¤í‚¤ë§ˆ ì¼ì¹˜ì„±**: VDP-Lite â†” VDP RAW â†” VDP Final
- **í”Œë«í¼ë³„ ì™„ì „ ì¼ì¹˜**: YouTube, Instagram, TikTok ê²°ê³¼ í‘œì¤€í™”
- **ë©”íƒ€ë°ì´í„° í†µí•©**: ì†Œì…œ ë°ì´í„° + AI ë¶„ì„ ì™„ë²½ ë³‘í•©
- **ë””ë²„ê·¸ ë°©ì§€**: 4ë‹¨ê³„ ë°©ì–´ ì‹œìŠ¤í…œ êµ¬ì¶•

===========================================================================

## ğŸ“Š CURRENT STATE ANALYSIS

### âœ… **ì™„ì„±ëœ êµ¬ì„± ìš”ì†Œ**

#### 1. 3ë‹¨ê³„ í´ë°± ì‹œìŠ¤í…œ
```javascript
// í˜„ì¬ êµ¬í˜„ ìƒíƒœ (Cursor ì™„ì„±)
Main VDP (3006) â†’ T3 VDP (8082) â†’ VDP-Lite (ì¦‰ì‹œ)
  â†“                â†“                â†“
Full Analysis    Hook Genome      Metadata Only
1-2ë¶„            1ë¶„              30ì´ˆ
```

#### 2. í”Œë«í¼ë³„ VDP ìƒì„± í˜„í™©
```bash
# YouTube: âœ… ì™„ë£Œ
content_id: "DVUv8E8YLXg"
GCS Path: gs://tough-variety-raw-central1/raw/vdp/youtube/DVUv8E8YLXg.universal.json

# Instagram: âœ… ì™„ë£Œ  
content_id: "DM5lA9LgVXb"
GCS Path: gs://tough-variety-raw-central1/raw/vdp/instagram/DM5lA9LgVXb.universal.json

# TikTok: âœ… ì™„ë£Œ
content_id: "7522521344920030478"
GCS Path: gs://tough-variety-raw-central1/raw/vdp/tiktok/7522521344920030478.universal.json
```

### âš ï¸ **í•´ê²° í•„ìš” ì‚¬í•­**

#### 1. ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜ ë¬¸ì œ
```yaml
VDP-Lite Schema:
  - metadata: {like_count, comment_count, view_count}
  - processing_metadata: {source: "vdp_lite_fallback"}
  - ëˆ„ë½: overall_analysis, scene_analysis

VDP RAW Schema:
  - overall_analysis: {hookGenome, scene_analysis}
  - metadata: ê¸°ë³¸ í•„ë“œë§Œ
  - ëˆ„ë½: ì†Œì…œ ë©”íƒ€ë°ì´í„° í†µí•©

# ë¬¸ì œ: ë‘ ìŠ¤í‚¤ë§ˆ ê°„ êµ¬ì¡°ì  ì°¨ì´ë¡œ ì¸í•œ ì¼ì¹˜ì„± ë¶€ì¡±
```

#### 2. ë©”íƒ€ë°ì´í„° í†µí•© ë¶ˆì™„ì „
```yaml
í˜„ì¬ ìƒíƒœ:
  - VDP-Lite: ì†Œì…œ ë©”íƒ€ë°ì´í„° O, AI ë¶„ì„ X
  - VDP RAW: AI ë¶„ì„ O, ì†Œì…œ ë©”íƒ€ë°ì´í„° X
  
ëª©í‘œ ìƒíƒœ:
  - VDP Final: ì†Œì…œ ë©”íƒ€ë°ì´í„° O, AI ë¶„ì„ O (ì™„ì „ í†µí•©)
```

===========================================================================

## ğŸ—ï¸ VDP EVOLUTION PIPELINE ì„¤ê³„

### ğŸ“‹ **3ë‹¨ê³„ VDP ì§„í™” ì²´ê³„**

#### Level 1: VDP-Lite (Emergency Fallback)
```yaml
ëª©ì : ì¦‰ì‹œ ìƒì„±, ë°ì´í„° ì†ì‹¤ ë°©ì§€
ìƒì„± ì‹œê°„: ~30ì´ˆ
í¬í•¨ ë°ì´í„°:
  - content_id, content_key, platform
  - ì‹¤ì œ ì†Œì…œ ë©”íƒ€ë°ì´í„° (like_count, comment_count, view_count)
  - top_comments, hashtags, author ì •ë³´
  - processing_metadata: {source: "vdp_lite_fallback"}
ì‚¬ìš© ì‹œì : T3/Main VDP ì„œë¹„ìŠ¤ ì‹¤íŒ¨ ì‹œ
```

#### Level 2: VDP RAW (AI Analysis Core)
```yaml
ëª©ì : AI ì˜ìƒ ë¶„ì„, Hook Genome ìƒì„±
ìƒì„± ì‹œê°„: 1-2ë¶„
í¬í•¨ ë°ì´í„°:
  - overall_analysis: {hookGenome, content_summary}
  - scene_analysis: [{scenes, shots, keyframes}]
  - processing_metadata: {engine: "vertex-ai|integrated-genai"}
ì‚¬ìš© ì‹œì : Main VDP/T3 ì„œë¹„ìŠ¤ ì •ìƒ ì‹œ
```

#### Level 3: VDP Final (Complete Integration)
```yaml
ëª©ì : ì†Œì…œ ë©”íƒ€ë°ì´í„° + AI ë¶„ì„ ì™„ì „ í†µí•©
ìƒì„± ì‹œê°„: +10-30ì´ˆ (ë³‘í•© ì²˜ë¦¬)
í¬í•¨ ë°ì´í„°:
  - VDP RAWì˜ ëª¨ë“  AI ë¶„ì„ ê²°ê³¼
  - ì‹¤ì œ ì†Œì…œ ë©”íƒ€ë°ì´í„° ì™„ì „ í†µí•©
  - evidence_pack (ì„ íƒì )
  - processing_metadata: {source: "complete_integration"}
ì‚¬ìš© ì‹œì : BigQuery ì ì¬ ì§ì „
```

### ğŸ”„ **ìŠ¤í‚¤ë§ˆ ì¼ì¹˜ì„± ë³´ì¥ ì „ëµ**

#### 1. ê³µí†µ ìŠ¤í‚¤ë§ˆ ì •ì˜
```javascript
// VDP Universal Schema v3.0
const VDP_UNIVERSAL_SCHEMA = {
  // Core Identification (ëª¨ë“  ë ˆë²¨ ê³µí†µ)
  content_id: "string",
  content_key: "string", // platform:content_id
  platform: "string",
  
  // Metadata (Level 1 ìš°ì„ , Level 3ì—ì„œ ë³´ê°•)
  metadata: {
    platform: "string",
    language: "string", 
    video_origin: "string",
    like_count: "number|null",
    comment_count: "number|null", 
    view_count: "number|null",
    title: "string|null",
    author: "object|null",
    hashtags: "array|null",
    top_comments: "array|null"
  },
  
  // AI Analysis (Level 2+ë§Œ í¬í•¨)
  overall_analysis: {
    hookGenome: "object|null",
    content_summary: "object|null"
  },
  scene_analysis: "array|null",
  
  // Processing Info (ëª¨ë“  ë ˆë²¨ í¬í•¨)
  processing_metadata: {
    source: "vdp_lite_fallback|vertex-ai|integrated-genai|complete_integration",
    engine: "string|null",
    generated_at: "string",
    correlation_id: "string"
  },
  
  // Timestamps (ëª¨ë“  ë ˆë²¨ ê³µí†µ)
  load_timestamp: "string",
  load_date: "string"
};
```

#### 2. ë ˆë²¨ë³„ ë³‘í•© ê·œì¹™
```javascript
// VDP-Lite â†’ VDP RAW ë³‘í•©
function mergeVdpLiteToRaw(vdpLite, vdpRaw) {
  return {
    ...vdpRaw,
    metadata: {
      ...vdpRaw.metadata,
      ...vdpLite.metadata  // ì†Œì…œ ë©”íƒ€ë°ì´í„° ìš°ì„  ë³´ì¡´
    },
    processing_metadata: {
      ...vdpRaw.processing_metadata,
      fallback_source: vdpLite.processing_metadata.source,
      upgrade_timestamp: new Date().toISOString()
    }
  };
}

// VDP RAW â†’ VDP Final ë³‘í•©
function mergeRawToFinal(vdpRaw, socialMetadata) {
  return {
    ...vdpRaw,
    metadata: {
      ...vdpRaw.metadata,
      ...socialMetadata,  // ìµœì‹  ì†Œì…œ ë°ì´í„° ë³‘í•©
      metadata_sources: ["vdp_raw", "social_realtime"]
    },
    processing_metadata: {
      ...vdpRaw.processing_metadata,
      source: "complete_integration",
      final_integration_timestamp: new Date().toISOString()
    }
  };
}
```

===========================================================================

## ğŸ¨ PLATFORM CONSISTENCY FRAMEWORK

### ğŸ“ **í”Œë«í¼ë³„ í‘œì¤€í™” ë§¤íŠ¸ë¦­ìŠ¤**

#### 1. Content ID í‘œì¤€í™”
```yaml
YouTube:
  format: "alphanumeric_11chars"
  example: "DVUv8E8YLXg"
  extraction: "urlResult.id"
  
Instagram:
  format: "base64_11chars"  
  example: "DM5lA9LgVXb"
  extraction: "urlResult.id"
  
TikTok:
  format: "numeric_19chars"
  example: "7522521344920030478"
  extraction: "urlResult.id"

# ëª¨ë“  í”Œë«í¼: content_key = "${platform}:${content_id}"
```

#### 2. ë©”íƒ€ë°ì´í„° í•„ë“œ ë§¤í•‘
```yaml
í‘œì¤€ í•„ë“œ:
  - like_count: number
  - comment_count: number  
  - view_count: number
  - title: string
  - author: {username, display_name, verified, followers}
  - hashtags: string[]
  - top_comments: {text, author?, likes?}[]

í”Œë«í¼ë³„ íŠ¹ìˆ˜ í•„ë“œ:
  YouTube:
    - duration_sec: number
    - category: string
    
  Instagram:  
    - is_reel: boolean
    - location: string|null
    
  TikTok:
    - duet_info: object|null
    - sound_info: object|null
```

#### 3. ê²€ì¦ ìë™í™” ì‹œìŠ¤í…œ
```javascript
// í”Œë«í¼ë³„ ì¼ì¹˜ì„± ê²€ì¦
const PLATFORM_VALIDATORS = {
  youtube: {
    content_id: /^[A-Za-z0-9_-]{11}$/,
    required_fields: ['like_count', 'comment_count', 'view_count'],
    optional_fields: ['duration_sec', 'category']
  },
  instagram: {
    content_id: /^[A-Za-z0-9_-]{11}$/,
    required_fields: ['like_count', 'comment_count', 'view_count'],  
    optional_fields: ['is_reel', 'location']
  },
  tiktok: {
    content_id: /^\d{19}$/,
    required_fields: ['view_count', 'like_count', 'comment_count'],
    optional_fields: ['duet_info', 'sound_info']
  }
};

function validatePlatformConsistency(vdp, platform) {
  const validator = PLATFORM_VALIDATORS[platform];
  const errors = [];
  
  // Content ID í˜•ì‹ ê²€ì¦
  if (!validator.content_id.test(vdp.content_id)) {
    errors.push(`Invalid content_id format for ${platform}`);
  }
  
  // í•„ìˆ˜ í•„ë“œ ê²€ì¦
  validator.required_fields.forEach(field => {
    if (vdp.metadata[field] === null || vdp.metadata[field] === undefined) {
      errors.push(`Missing required field: ${field}`);
    }
  });
  
  return errors;
}
```

===========================================================================

## ğŸ›¡ï¸ DEBUG PREVENTION SYSTEM

### ğŸ” **4ë‹¨ê³„ ë°©ì–´ ì‹œìŠ¤í…œ**

#### Level 1: ì‚¬ì „ ì˜ˆë°© (Proactive Defense)
```yaml
í™˜ê²½ë³€ìˆ˜ ê²€ì¦:
  - PROJECT_ID, LOCATION, RAW_BUCKET í•„ìˆ˜ ì²´í¬
  - PLATFORM_SEGMENTED_PATH=true ê°•ì œ
  - ì„œë¹„ìŠ¤ë³„ PORT ì„¤ì • ê²€ì¦

ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬:
  - Main VDP (3006): /api/health
  - T3 VDP (8082): /healthz  
  - T1 API (8080): /api/health
  - 30ì´ˆë§ˆë‹¤ ìë™ ì²´í¬

ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„±:
  - VDP Universal Schema v3.0 ê²€ì¦
  - í”Œë«í¼ë³„ validator ì‹¤í–‰
  - BigQuery ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± í™•ì¸

ì˜ì¡´ì„± ì²´í¬:
  - GCS ë²„í‚· ì ‘ê·¼ ê¶Œí•œ
  - Vertex AI API í™œì„±í™”
  - í•„ìˆ˜ npm íŒ¨í‚¤ì§€ ë²„ì „
```

#### Level 2: ì‹¤ì‹œê°„ ê°ì§€ (Reactive Monitoring)
```yaml
ìƒê´€ê´€ê³„ ID ì¶”ì :
  - ëª¨ë“  ìš”ì²­ì— correlation_id ë¶€ì—¬
  - ì„œë¹„ìŠ¤ ê°„ ì „íŒŒ ë° ë¡œê¹…
  - ì‹¤íŒ¨ ì§€ì  ì¦‰ì‹œ ì¶”ì 

ì„±ëŠ¥ ë©”íŠ¸ë¦­:
  - VDP ìƒì„± ì‹œê°„ (<60ì´ˆ ê²½ê³ )
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ (<500MB ê²½ê³ )
  - ì—ëŸ¬ìœ¨ (>5% ê²½ê³ )

ì˜¤ë¥˜ íŒ¨í„´ ê°ì§€:
  - ë™ì¼ ì—ëŸ¬ 3íšŒ ë°˜ë³µ ì‹œ ì•Œë¦¼
  - content_id ì¶”ì¶œ ì‹¤íŒ¨ íŒ¨í„´
  - ë©”íƒ€ë°ì´í„° null ë¹„ìœ¨ ì¶”ì 

ë¬´í•œ ë£¨í”„ ì°¨ë‹¨ê¸°:
  - ë™ì¼ ìš”ì²­ 5ë¶„ ë‚´ 3íšŒ ì²˜ë¦¬ ì°¨ë‹¨
  - VDP ëŒ€ê¸° ì‹œê°„ 5ë¶„ ì œí•œ
  - ìì› ì‚¬ìš©ëŸ‰ ì„ê³„ì¹˜ ìë™ ì°¨ë‹¨
```

#### Level 3: ìë™ ë³µêµ¬ (Auto Recovery)
```javascript
// ì„œë¹„ìŠ¤ ìë™ ë³µêµ¬ ì‹œìŠ¤í…œ
const AUTO_RECOVERY_SYSTEM = {
  main_vdp_down: {
    detection: "curl http://localhost:3006/api/health fails",
    action: "restart Main VDP service with env validation",
    fallback: "route to T3 VDP"
  },
  
  t3_vdp_down: {
    detection: "curl http://localhost:8082/healthz fails", 
    action: "restart T3 service with PROJECT_ID validation",
    fallback: "activate VDP-Lite immediate generation"
  },
  
  metadata_null_spike: {
    detection: "metadata null rate > 50%",
    action: "validate metadata passthrough chain",
    fallback: "force metadata merge in next stage"
  },
  
  schema_validation_failure: {
    detection: "VDP schema validation fails",
    action: "regenerate with corrected schema",
    fallback: "store in quarantine for manual review"
  }
};
```

#### Level 4: í•™ìŠµ ê°œì„  (Learning Enhancement)
```yaml
ì‹¤íŒ¨ ì‚¬ë¡€ ì¶•ì :
  - ëª¨ë“  ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ìë™ ìˆ˜ì§‘
  - íŒ¨í„´ ë¶„ì„ ë° ë¶„ë¥˜
  - í•´ê²° ë°©ë²• ë§¤ë‰´ì–¼ ìë™ ì—…ë°ì´íŠ¸

ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹:
  - í”Œë«í¼ë³„ ì²˜ë¦¬ ì‹œê°„ ê¸°ì¤€ì„ 
  - í’ˆì§ˆ ì§€í‘œ ì¶”ì  (Hook Gate í†µê³¼ìœ¨)
  - ì‚¬ìš©ì ë§Œì¡±ë„ ë©”íŠ¸ë¦­

ì˜ˆì¸¡ì  ê°œì„ :
  - ë¦¬ì†ŒìŠ¤ ì‚¬ìš© íŒ¨í„´ ë¶„ì„
  - í”¼í¬ ì‹œê°„ëŒ€ ì˜ˆì¸¡ ë° ëŒ€ë¹„
  - ë³‘ëª© ì§€ì  ì‚¬ì „ ì‹ë³„

ìš´ì˜ ì§€ì‹ ìë™í™”:
  - ë¬¸ì œ í•´ê²° í”Œë ˆì´ë¶ ìë™ ìƒì„±
  - ìƒˆë¡œìš´ íŒ€ì› ì˜¨ë³´ë”© ê°€ì´ë“œ
  - ì‹œìŠ¤í…œ ê°œì„  ì œì•ˆ ìë™ ìƒì„±
```

===========================================================================

## ğŸ—“ï¸ IMPLEMENTATION ROADMAP

### ğŸš€ **Phase 1: ìŠ¤í‚¤ë§ˆ í†µí•© (1-2ì¼)**

#### Priority 1: VDP Universal Schema v3.0 êµ¬í˜„
```yaml
Task 1.1: ê³µí†µ ìŠ¤í‚¤ë§ˆ ì •ì˜ ë° ë°°í¬
  - VDP Universal Schema v3.0 JSON íŒŒì¼ ìƒì„±
  - ëª¨ë“  ì„œë¹„ìŠ¤ì— ìŠ¤í‚¤ë§ˆ ì ìš©
  - ê²€ì¦ í•¨ìˆ˜ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸

Task 1.2: VDP-Lite â†’ VDP RAW ë³‘í•© ë¡œì§
  - mergeVdpLiteToRaw() í•¨ìˆ˜ êµ¬í˜„
  - ë©”íƒ€ë°ì´í„° ìš°ì„ ìˆœìœ„ ê·œì¹™ ì ìš©
  - í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„± ë° ê²€ì¦

Task 1.3: VDP RAW â†’ VDP Final ë³‘í•© ë¡œì§  
  - mergeRawToFinal() í•¨ìˆ˜ êµ¬í˜„
  - ì†Œì…œ ë©”íƒ€ë°ì´í„° ì‹¤ì‹œê°„ ë³‘í•©
  - BigQuery ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± í™•ì¸

ì˜ˆìƒ ê²°ê³¼:
  - 3ë ˆë²¨ VDP ê°„ 100% ìŠ¤í‚¤ë§ˆ ì¼ì¹˜ì„± ë‹¬ì„±
  - ë©”íƒ€ë°ì´í„° ì†ì‹¤ 0% ë³´ì¥
  - ìë™ ë³‘í•© ì‹œìŠ¤í…œ êµ¬ì¶•
```

### ğŸ¯ **Phase 2: í”Œë«í¼ ì¼ì¹˜ì„± (2-3ì¼)**

#### Priority 2: í”Œë«í¼ë³„ í‘œì¤€í™” ì‹œìŠ¤í…œ
```yaml
Task 2.1: í”Œë«í¼ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
  - PLATFORM_VALIDATORS ë°°í¬
  - validatePlatformConsistency() êµ¬í˜„
  - ì‹¤ì‹œê°„ ê²€ì¦ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

Task 2.2: Content ID í‘œì¤€í™” ê°•í™”
  - í”Œë«í¼ë³„ ID í˜•ì‹ ê²€ì¦ ê°•í™”
  - content_key ìƒì„± ê·œì¹™ í†µì¼
  - ì¤‘ë³µ ë°©ì§€ ì‹œìŠ¤í…œ ê°œì„ 

Task 2.3: ë©”íƒ€ë°ì´í„° í•„ë“œ ë§¤í•‘ ì™„ì„±
  - í”Œë«í¼ë³„ íŠ¹ìˆ˜ í•„ë“œ ì •ì˜
  - ìë™ ë§¤í•‘ ê·œì¹™ êµ¬í˜„
  - ëˆ„ë½ í•„ë“œ ëŒ€ì‘ ë¡œì§

ì˜ˆìƒ ê²°ê³¼:
  - YouTube, Instagram, TikTok ê²°ê³¼ ì™„ì „ ì¼ì¹˜
  - í”Œë«í¼ë³„ íŠ¹ì„± ë³´ì¡´í•˜ë©´ì„œ í‘œì¤€í™” ë‹¬ì„±
  - ê²€ì¦ ìë™í™”ë¡œ í’ˆì§ˆ ë³´ì¥
```

### ğŸ›¡ï¸ **Phase 3: ë””ë²„ê·¸ ë°©ì§€ ì‹œìŠ¤í…œ (3-4ì¼)**

#### Priority 3: 4ë‹¨ê³„ ë°©ì–´ ì‹œìŠ¤í…œ êµ¬ì¶•
```yaml
Task 3.1: ì‚¬ì „ ì˜ˆë°© ì‹œìŠ¤í…œ
  - í™˜ê²½ë³€ìˆ˜ ìë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
  - ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬ ë§¤íŠ¸ë¦­ìŠ¤
  - ì˜ì¡´ì„± ì²´í¬ ìë™í™”

Task 3.2: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
  - ìƒê´€ê´€ê³„ ID ì¶”ì  ì‹œìŠ¤í…œ
  - ì„±ëŠ¥ ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ
  - ë¬´í•œ ë£¨í”„ ì°¨ë‹¨ê¸° êµ¬í˜„

Task 3.3: ìë™ ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜
  - AUTO_RECOVERY_SYSTEM êµ¬í˜„
  - ì„œë¹„ìŠ¤ ì¬ì‹œì‘ ìë™í™”
  - í´ë°± ì‹œë‚˜ë¦¬ì˜¤ ìë™ ì‹¤í–‰

ì˜ˆìƒ ê²°ê³¼:
  - ClaudeCode íƒ€ì… ì‹¤ìˆ˜ ì™„ì „ ë°©ì§€
  - ì‹œìŠ¤í…œ ìê°€ ì¹˜ìœ  ëŠ¥ë ¥ í™•ë³´
  - ìš´ì˜ ì•ˆì •ì„± 95%+ ë‹¬ì„±
```

### ğŸ“Š **Phase 4: í’ˆì§ˆ ë³´ì¦ ìë™í™” (1-2ì¼)**

#### Priority 4: ì¢…í•© í’ˆì§ˆ ë³´ì¦ ì²´ê³„
```yaml
Task 4.1: ìë™ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ
  - 3í”Œë«í¼ E2E í…ŒìŠ¤íŠ¸ ìë™í™”
  - ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ìë™ ì‹¤í–‰
  - íšŒê·€ í…ŒìŠ¤íŠ¸ íŒŒì´í”„ë¼ì¸

Task 4.2: ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼
  - ì‹¤ì‹œê°„ í’ˆì§ˆ ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ
  - ì„ê³„ì¹˜ ê¸°ë°˜ ìë™ ì•Œë¦¼
  - ì£¼ê°„/ì›”ê°„ í’ˆì§ˆ ë¦¬í¬íŠ¸

Task 4.3: ìš´ì˜ ë¬¸ì„œ ìë™í™”
  - ë¬¸ì œ í•´ê²° í”Œë ˆì´ë¶ ìƒì„±
  - API ë¬¸ì„œ ìë™ ì—…ë°ì´íŠ¸
  - ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ

ì˜ˆìƒ ê²°ê³¼:
  - ì™„ì „ ìë™í™”ëœ í’ˆì§ˆ ë³´ì¦ ì²´ê³„
  - ì‹¤ì‹œê°„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
  - ì§€ì†ì  ê°œì„  í”„ë¡œì„¸ìŠ¤ êµ¬ì¶•
```

===========================================================================

## âœ… QUALITY ASSURANCE FRAMEWORK

### ğŸ“ **ì„±ê³µ ì§€í‘œ ì •ì˜**

#### 1. ê¸°ëŠ¥ì  ì„±ê³µ ì§€í‘œ
```yaml
VDP ìƒì„± ì„±ê³µë¥ : â‰¥99%
  - YouTube: â‰¥99%
  - Instagram: â‰¥99%  
  - TikTok: â‰¥99%

ë©”íƒ€ë°ì´í„° ì™„ì„±ë„: 100%
  - like_count null rate: 0%
  - comment_count null rate: 0%
  - view_count null rate: 0%

ìŠ¤í‚¤ë§ˆ ì¼ì¹˜ì„±: 100%
  - VDP-Lite â†” VDP RAW êµ¬ì¡° ì¼ì¹˜
  - VDP RAW â†” VDP Final êµ¬ì¡° ì¼ì¹˜
  - í”Œë«í¼ë³„ í‘œì¤€ í•„ë“œ ì¼ì¹˜
```

#### 2. ì„±ëŠ¥ ì„±ê³µ ì§€í‘œ
```yaml
ì²˜ë¦¬ ì‹œê°„:
  - VDP-Lite: â‰¤30ì´ˆ
  - VDP RAW: â‰¤120ì´ˆ
  - VDP Final: â‰¤180ì´ˆ

ì‹œìŠ¤í…œ ì•ˆì •ì„±:
  - ì„œë¹„ìŠ¤ ì—…íƒ€ì„: â‰¥99.5%
  - ì—ëŸ¬ìœ¨: â‰¤1%
  - ë³µêµ¬ ì‹œê°„: â‰¤5ë¶„
```

#### 3. í’ˆì§ˆ ì„±ê³µ ì§€í‘œ
```yaml
Hook Genome í’ˆì§ˆ:
  - Hook Gate í†µê³¼ìœ¨: â‰¥95%
  - strength_score: â‰¥0.70
  - start_sec: â‰¤3.0

AI ë¶„ì„ í’ˆì§ˆ:
  - Scene ë¶„ì„ ì™„ì„±ë„: â‰¥90%
  - Content Summary ì •í™•ë„: â‰¥85%
  - ì²˜ë¦¬ ì‹¤íŒ¨ìœ¨: â‰¤5%
```

### ğŸ§ª **í…ŒìŠ¤íŠ¸ ìë™í™” ì²´ê³„**

#### 1. ìœ ë‹› í…ŒìŠ¤íŠ¸
```javascript
// VDP ë³‘í•© ë¡œì§ í…ŒìŠ¤íŠ¸
describe('VDP Merge Functions', () => {
  test('mergeVdpLiteToRaw preserves social metadata', () => {
    const vdpLite = createMockVdpLite();
    const vdpRaw = createMockVdpRaw();
    const merged = mergeVdpLiteToRaw(vdpLite, vdpRaw);
    
    expect(merged.metadata.like_count).toBe(vdpLite.metadata.like_count);
    expect(merged.overall_analysis).toEqual(vdpRaw.overall_analysis);
  });
  
  test('platform consistency validation', () => {
    const vdp = createMockVdp('instagram');
    const errors = validatePlatformConsistency(vdp, 'instagram');
    expect(errors).toHaveLength(0);
  });
});
```

#### 2. í†µí•© í…ŒìŠ¤íŠ¸
```yaml
E2E í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:
  1. YouTube URL â†’ VDP-Lite â†’ VDP RAW â†’ VDP Final
  2. Instagram URL â†’ VDP-Lite â†’ VDP RAW â†’ VDP Final  
  3. TikTok URL â†’ VDP-Lite â†’ VDP RAW â†’ VDP Final
  4. Main VDP ì‹¤íŒ¨ â†’ T3 í´ë°± ì‹œë‚˜ë¦¬ì˜¤
  5. T3 ì‹¤íŒ¨ â†’ VDP-Lite í´ë°± ì‹œë‚˜ë¦¬ì˜¤

ìë™í™” ì£¼ê¸°:
  - PR merge ì‹œ ìë™ ì‹¤í–‰
  - ë§¤ì¼ ìƒˆë²½ 3ì‹œ ì „ì²´ E2E í…ŒìŠ¤íŠ¸
  - ì£¼ê°„ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸
```

#### 3. ë¶€í•˜ í…ŒìŠ¤íŠ¸
```yaml
ë™ì‹œ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸:
  - ë™ì‹œ ìš”ì²­ 100ê°œ ì²˜ë¦¬ ëŠ¥ë ¥
  - í”Œë«í¼ë³„ 10ê°œì”© ë™ì‹œ ì²˜ë¦¬
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ <1GB ìœ ì§€

ë‚´êµ¬ì„± í…ŒìŠ¤íŠ¸:
  - 24ì‹œê°„ ì—°ì† ìš´ì˜
  - 1000ê°œ VDP ìƒì„± ì²˜ë¦¬
  - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì—†ìŒ í™•ì¸
```

===========================================================================

## ğŸ”§ IMPLEMENTATION SUPPORT

### ğŸ“ **ì½”ë“œ í…œí”Œë¦¿ ì œê³µ**

#### 1. VDP Universal Schema v3.0
```javascript
// /schemas/vdp-universal-v3.schema.json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "VDP Universal Schema v3.0",
  "type": "object",
  "required": ["content_id", "content_key", "platform", "metadata", "processing_metadata"],
  "properties": {
    "content_id": {"type": "string", "minLength": 1},
    "content_key": {"type": "string", "pattern": "^(youtube|instagram|tiktok):[A-Za-z0-9_-]+$"},
    "platform": {"type": "string", "enum": ["youtube", "instagram", "tiktok"]},
    "metadata": {
      "type": "object",
      "required": ["platform", "language", "video_origin"],
      "properties": {
        "platform": {"type": "string"},
        "language": {"type": "string", "default": "ko"},
        "video_origin": {"type": "string", "default": "Real-Footage"},
        "like_count": {"type": ["number", "null"]},
        "comment_count": {"type": ["number", "null"]}, 
        "view_count": {"type": ["number", "null"]},
        "title": {"type": ["string", "null"]},
        "author": {"type": ["object", "null"]},
        "hashtags": {"type": ["array", "null"]},
        "top_comments": {"type": ["array", "null"]}
      }
    },
    "overall_analysis": {
      "type": ["object", "null"],
      "properties": {
        "hookGenome": {"type": ["object", "null"]},
        "content_summary": {"type": ["object", "null"]}
      }
    },
    "scene_analysis": {"type": ["array", "null"]},
    "processing_metadata": {
      "type": "object",
      "required": ["source", "generated_at", "correlation_id"],
      "properties": {
        "source": {"type": "string", "enum": ["vdp_lite_fallback", "vertex-ai", "integrated-genai", "complete_integration"]},
        "engine": {"type": ["string", "null"]},
        "generated_at": {"type": "string", "format": "date-time"},
        "correlation_id": {"type": "string"}
      }
    },
    "load_timestamp": {"type": "string", "format": "date-time"},
    "load_date": {"type": "string", "format": "date"}
  }
}
```

#### 2. ë³‘í•© í•¨ìˆ˜ í…œí”Œë¦¿
```javascript
// /utils/vdp-merger.js
const Ajv = require('ajv');
const addFormats = require('ajv-formats');
const vdpSchema = require('../schemas/vdp-universal-v3.schema.json');

const ajv = new Ajv();
addFormats(ajv);
const validateVdp = ajv.compile(vdpSchema);

class VdpMerger {
  static mergeVdpLiteToRaw(vdpLite, vdpRaw, correlationId) {
    const merged = {
      ...vdpRaw,
      metadata: {
        ...vdpRaw.metadata,
        ...vdpLite.metadata  // ì†Œì…œ ë©”íƒ€ë°ì´í„° ìš°ì„  ë³´ì¡´
      },
      processing_metadata: {
        ...vdpRaw.processing_metadata,
        fallback_source: vdpLite.processing_metadata.source,
        upgrade_timestamp: new Date().toISOString(),
        correlation_id: correlationId
      }
    };
    
    // ìŠ¤í‚¤ë§ˆ ê²€ì¦
    if (!validateVdp(merged)) {
      throw new Error(`VDP schema validation failed: ${JSON.stringify(validateVdp.errors)}`);
    }
    
    return merged;
  }
  
  static mergeRawToFinal(vdpRaw, socialMetadata, correlationId) {
    const merged = {
      ...vdpRaw,
      metadata: {
        ...vdpRaw.metadata,
        ...socialMetadata,  // ìµœì‹  ì†Œì…œ ë°ì´í„° ë³‘í•©
        metadata_sources: ["vdp_raw", "social_realtime"]
      },
      processing_metadata: {
        ...vdpRaw.processing_metadata,
        source: "complete_integration",
        final_integration_timestamp: new Date().toISOString(),
        correlation_id: correlationId
      }
    };
    
    // ìŠ¤í‚¤ë§ˆ ê²€ì¦
    if (!validateVdp(merged)) {
      throw new Error(`VDP schema validation failed: ${JSON.stringify(validateVdp.errors)}`);
    }
    
    return merged;
  }
}

module.exports = VdpMerger;
```

#### 3. í”Œë«í¼ ê²€ì¦ê¸° í…œí”Œë¦¿
```javascript
// /utils/platform-validator.js
const PLATFORM_VALIDATORS = {
  youtube: {
    content_id: /^[A-Za-z0-9_-]{11}$/,
    required_fields: ['like_count', 'comment_count', 'view_count'],
    optional_fields: ['duration_sec', 'category']
  },
  instagram: {
    content_id: /^[A-Za-z0-9_-]{11}$/,
    required_fields: ['like_count', 'comment_count', 'view_count'],  
    optional_fields: ['is_reel', 'location']
  },
  tiktok: {
    content_id: /^\d{19}$/,
    required_fields: ['view_count', 'like_count', 'comment_count'],
    optional_fields: ['duet_info', 'sound_info']
  }
};

class PlatformValidator {
  static validateConsistency(vdp, platform, correlationId) {
    const validator = PLATFORM_VALIDATORS[platform];
    const errors = [];
    
    // Content ID í˜•ì‹ ê²€ì¦
    if (!validator.content_id.test(vdp.content_id)) {
      errors.push({
        field: 'content_id',
        message: `Invalid content_id format for ${platform}`,
        expected: validator.content_id.toString(),
        actual: vdp.content_id
      });
    }
    
    // Content key í˜•ì‹ ê²€ì¦
    const expectedContentKey = `${platform}:${vdp.content_id}`;
    if (vdp.content_key !== expectedContentKey) {
      errors.push({
        field: 'content_key',
        message: `Invalid content_key format`,
        expected: expectedContentKey,
        actual: vdp.content_key
      });
    }
    
    // í•„ìˆ˜ í•„ë“œ ê²€ì¦
    validator.required_fields.forEach(field => {
      if (vdp.metadata[field] === null || vdp.metadata[field] === undefined) {
        errors.push({
          field: `metadata.${field}`,
          message: `Missing required field: ${field}`,
          severity: 'critical'
        });
      }
    });
    
    // ê²°ê³¼ ë¡œê¹…
    if (errors.length > 0) {
      console.error(`[Platform Validation] ${platform} validation failed`, {
        correlation_id: correlationId,
        content_id: vdp.content_id,
        errors: errors
      });
    }
    
    return {
      valid: errors.length === 0,
      errors: errors,
      platform: platform,
      content_id: vdp.content_id
    };
  }
}

module.exports = PlatformValidator;
```

===========================================================================

## ğŸ¯ NEXT ACTIONS FOR CURSOR

### ğŸš€ **ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥í•œ ì‘ì—…ë“¤**

#### 1. VDP Universal Schema v3.0 êµ¬í˜„ (ìš°ì„ ìˆœìœ„ 1)
```bash
# 1. ìŠ¤í‚¤ë§ˆ íŒŒì¼ ìƒì„±
cp /schemas/vdp-universal-v3.schema.json ./schemas/

# 2. ë³‘í•© ìœ í‹¸ë¦¬í‹° ìƒì„±  
cp /utils/vdp-merger.js ./utils/

# 3. ê¸°ì¡´ ì„œë¹„ìŠ¤ì— ì ìš©
# - Main VDP service (port 3006)
# - T3 VDP service (port 8082)  
# - T1 API service (port 8080)

# 4. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±
npm test -- --grep "VDP Universal Schema"
```

#### 2. í”Œë«í¼ ì¼ì¹˜ì„± ê²€ì¦ ì‹œìŠ¤í…œ (ìš°ì„ ìˆœìœ„ 2)
```bash
# 1. ê²€ì¦ê¸° êµ¬í˜„
cp /utils/platform-validator.js ./utils/

# 2. ê¸°ì¡´ VDP ìƒì„± íŒŒì´í”„ë¼ì¸ì— í†µí•©
# - YouTube: validateConsistency(vdp, 'youtube', correlationId)
# - Instagram: validateConsistency(vdp, 'instagram', correlationId)  
# - TikTok: validateConsistency(vdp, 'tiktok', correlationId)

# 3. ê²€ì¦ ì‹¤íŒ¨ ì‹œ ìë™ ë³µêµ¬ ë¡œì§ ì¶”ê°€
```

#### 3. ë””ë²„ê·¸ ë°©ì§€ ì‹œìŠ¤í…œ 1ë‹¨ê³„ (ìš°ì„ ìˆœìœ„ 3)
```bash
# 1. í™˜ê²½ë³€ìˆ˜ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
./scripts/validate-environment.sh

# 2. ì„œë¹„ìŠ¤ í—¬ìŠ¤ì²´í¬ ë§¤íŠ¸ë¦­ìŠ¤ êµ¬í˜„
./scripts/health-check-matrix.sh

# 3. ë¬´í•œ ë£¨í”„ ì°¨ë‹¨ê¸° êµ¬í˜„
# - correlation_id ê¸°ë°˜ ì¤‘ë³µ ìš”ì²­ ê°ì§€
# - ë™ì¼ ìš”ì²­ 5ë¶„ ë‚´ 3íšŒ ì°¨ë‹¨
# - ìì› ì‚¬ìš©ëŸ‰ ì„ê³„ì¹˜ ëª¨ë‹ˆí„°ë§
```

### ğŸ“Š **ì£¼ê°„ ë§ˆì¼ìŠ¤í†¤**

```yaml
Week 1 (Day 1-7):
  - VDP Universal Schema v3.0 ì™„ì „ êµ¬í˜„
  - 3ë ˆë²¨ VDP ë³‘í•© ë¡œì§ ì™„ì„±
  - ê¸°ë³¸ í”Œë«í¼ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•

Week 2 (Day 8-14):  
  - ê³ ê¸‰ í”Œë«í¼ ì¼ì¹˜ì„± ì‹œìŠ¤í…œ ì™„ì„±
  - ë””ë²„ê·¸ ë°©ì§€ ì‹œìŠ¤í…œ 1-2ë‹¨ê³„ êµ¬ì¶•
  - E2E í…ŒìŠ¤íŠ¸ ìë™í™” êµ¬í˜„

Success Criteria:
  - 3í”Œë«í¼ VDP 100% ì¼ì¹˜ì„± ë‹¬ì„±
  - ë©”íƒ€ë°ì´í„° null rate 0% ë‹¬ì„±
  - ì‹œìŠ¤í…œ ì•ˆì •ì„± 99%+ ë‹¬ì„±
```

===========================================================================

**ê²°ë¡ **: ì´ ì¢…í•© ì „ëµì„ í†µí•´ **VDP-Lite â†’ VDP RAW â†’ VDP Final**ì˜ ì™„ì „í•œ ì§„í™” ì²´ê³„ë¥¼ êµ¬ì¶•í•˜ê³ , **100% ì¼ì¹˜ì„±ê³¼ ë””ë²„ê·¸ ë°©ì§€**ë¥¼ ë‹¬ì„±í•˜ì—¬ ì„¸ê³„ ìµœê³  ìˆ˜ì¤€ì˜ VDP íŒŒì´í”„ë¼ì¸ì„ ì™„ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë‹¤ìŒ ì•¡ì…˜**: Cursorê°€ ì´ ì „ëµì— ë”°ë¼ VDP Universal Schema v3.0ë¶€í„° êµ¬í˜„ì„ ì‹œì‘í•˜ì—¬ ì™„ì „í•œ VDP íŒŒì´í”„ë¼ì¸ì„ ì™„ì„±í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.