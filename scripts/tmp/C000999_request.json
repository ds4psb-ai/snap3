{
  "contents": [
    {
      "role": "user",
      "parts": [
        {
          "file_data": {
            "file_uri": "gs://tough-variety-raw/raw/ingest/6_I2FmT1mbY.mp4",
            "mime_type": "video/mp4"
          }
        },
        {
          "text": "Analyze this video and provide a complete VDP analysis following the strict schema requirements. \n\nVideo Content ID: C000999\nPlatform: Determine from content style and format\nDuration: Extract from video analysis\nVideo Origin: Determine if AI-Generated, Real-Footage, or Mixed based on visual analysis\n\nPlease generate a comprehensive VDP with:\n- Accurate metadata including engagement metrics\n- Detailed scene-by-scene breakdown with shots and keyframes  \n- Product/service mentions with time ranges\n- Audience reaction analysis with confidence scores\n- ASR transcript and OCR text extraction\n- Overall narrative and emotional arc analysis\n\nEnsure all timing data is consistent and realistic for the video content."
        }
      ]
    }
  ],
  "system_instruction": {
    "parts": [
      {
        "text": "You are a professional video content analyst specializing in short-form video analysis for social media platforms (YouTube Shorts, Instagram Reels, TikTok). \n\nYour task is to analyze the provided video and generate a comprehensive VDP (Video Data Package) that follows the exact schema structure provided. \n\nKey requirements:\n1. Analyze visual content, audio, text overlays, and overall narrative structure\n2. Break down the video into distinct scenes with detailed shot analysis\n3. Identify products, services, and brand mentions with time stamps\n4. Extract audience engagement patterns and emotional arc\n5. Provide confidence scores for all analysis (target: >0.9)\n6. Ensure all required fields are populated with accurate, detailed information\n7. Generate realistic engagement metrics appropriate for the content type\n8. Follow Korean social media conventions where applicable\n\nThe response must strictly conform to the provided JSON schema structure."
      }
    ]
  },
  "generation_config": {
    "temperature": 0.1,
    "max_output_tokens": 32768,
    "response_mime_type": "application/json",
    "response_schema": {
      "type": "object",
      "required": [
        "content_id",
        "metadata",
        "overall_analysis",
        "product_mentions",
        "scenes",
        "service_mentions",
        "default_lang"
      ],
      "additionalProperties": false,
      "properties": {
        "content_id": {
          "type": "string",
          "pattern": "^C\\d{6}$",
          "description": "Content identifier in format C######"
        },
        "metadata": {
          "type": "object",
          "required": [
            "comment_count",
            "cta_types",
            "hashtags",
            "like_count",
            "original_sound",
            "platform",
            "share_count",
            "source_url",
            "upload_date",
            "video_origin",
            "view_count"
          ],
          "additionalProperties": false,
          "properties": {
            "comment_count": {
              "type": "integer",
              "minimum": 0,
              "maximum": 1000000000
            },
            "cta_types": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "comment",
                  "share",
                  "follow",
                  "like",
                  "visit_profile",
                  "external_link",
                  "purchase",
                  "subscribe"
                ]
              }
            },
            "hashtags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "like_count": {
              "type": "integer",
              "minimum": 0,
              "maximum": 1000000000
            },
            "original_sound": {
              "type": "boolean",
              "description": "Whether video uses original sound or music"
            },
            "platform": {
              "type": "string",
              "enum": [
                "instagram",
                "tiktok",
                "youtube_shorts"
              ],
              "description": "Social media platform"
            },
            "share_count": {
              "type": "integer",
              "minimum": 0,
              "maximum": 1000000000
            },
            "source_url": {
              "type": "string",
              "description": "Original source URL"
            },
            "upload_date": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$",
              "description": "ISO 8601 date format"
            },
            "video_origin": {
              "type": "string",
              "enum": [
                "Real-Footage",
                "AI-Generated",
                "Mixed"
              ],
              "description": "Source type of video content"
            },
            "view_count": {
              "type": "integer",
              "minimum": 0,
              "maximum": 1000000000
            }
          }
        },
        "overall_analysis": {
          "type": "object",
          "required": [
            "asr_transcript",
            "asr_translation_en",
            "audience_reaction",
            "comedic_timing",
            "confidence",
            "emotional_arc",
            "hook_effectiveness",
            "narrative_structure",
            "ocr_text",
            "potential_meme_template",
            "top_comments"
          ],
          "additionalProperties": false,
          "properties": {
            "asr_transcript": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "text",
                  "start_time",
                  "end_time",
                  "confidence"
                ],
                "properties": {
                  "text": {
                    "type": "string"
                  },
                  "start_time": {
                    "type": "number",
                    "minimum": 0
                  },
                  "end_time": {
                    "type": "number",
                    "minimum": 0
                  },
                  "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  }
                }
              }
            },
            "asr_translation_en": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "text",
                  "start_time",
                  "end_time"
                ],
                "properties": {
                  "text": {
                    "type": "string"
                  },
                  "start_time": {
                    "type": "number",
                    "minimum": 0
                  },
                  "end_time": {
                    "type": "number",
                    "minimum": 0
                  }
                }
              }
            },
            "audience_reaction": {
              "type": "object",
              "required": [
                "common_reactions",
                "notable_comments",
                "overall_sentiment"
              ],
              "properties": {
                "common_reactions": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "notable_comments": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "lang",
                      "text",
                      "translation_en"
                    ],
                    "properties": {
                      "lang": {
                        "type": "string"
                      },
                      "text": {
                        "type": "string"
                      },
                      "translation_en": {
                        "type": "string"
                      }
                    }
                  }
                },
                "overall_sentiment": {
                  "type": "string"
                }
              }
            },
            "comedic_timing": {
              "type": "object",
              "required": [
                "beats",
                "overall_rhythm"
              ],
              "properties": {
                "beats": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "type",
                      "timing",
                      "effectiveness"
                    ],
                    "properties": {
                      "type": {
                        "type": "string"
                      },
                      "timing": {
                        "type": "number",
                        "minimum": 0
                      },
                      "effectiveness": {
                        "type": "string",
                        "enum": [
                          "low",
                          "medium",
                          "high"
                        ]
                      }
                    }
                  }
                },
                "overall_rhythm": {
                  "type": "string"
                }
              }
            },
            "confidence": {
              "type": "object",
              "required": [
                "overall",
                "scene_detection",
                "audio_analysis"
              ],
              "properties": {
                "overall": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1
                },
                "scene_detection": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1
                },
                "audio_analysis": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1
                }
              }
            },
            "emotional_arc": {
              "type": "object",
              "required": [
                "start",
                "peak",
                "end"
              ],
              "properties": {
                "start": {
                  "type": "string"
                },
                "peak": {
                  "type": "string"
                },
                "end": {
                  "type": "string"
                }
              }
            },
            "hook_effectiveness": {
              "type": "object",
              "required": [
                "score",
                "elements",
                "improvement_suggestions"
              ],
              "properties": {
                "score": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 10
                },
                "elements": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "improvement_suggestions": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            },
            "narrative_structure": {
              "type": "object",
              "required": [
                "type",
                "components"
              ],
              "properties": {
                "type": {
                  "type": "string"
                },
                "components": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            },
            "ocr_text": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "text",
                  "timestamp",
                  "confidence"
                ],
                "properties": {
                  "text": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "number",
                    "minimum": 0
                  },
                  "confidence": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1
                  }
                }
              }
            },
            "potential_meme_template": {
              "type": "object",
              "required": [
                "is_template",
                "template_type",
                "viral_potential"
              ],
              "properties": {
                "is_template": {
                  "type": "boolean"
                },
                "template_type": {
                  "type": "string"
                },
                "viral_potential": {
                  "type": "string",
                  "enum": [
                    "low",
                    "medium",
                    "high"
                  ]
                }
              }
            },
            "top_comments": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "text",
                  "author",
                  "engagement"
                ],
                "properties": {
                  "text": {
                    "type": "string"
                  },
                  "author": {
                    "type": "string"
                  },
                  "engagement": {
                    "type": "object",
                    "required": [
                      "likes",
                      "replies"
                    ],
                    "properties": {
                      "likes": {
                        "type": "integer",
                        "minimum": 0
                      },
                      "replies": {
                        "type": "integer",
                        "minimum": 0
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "product_mentions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "type",
              "category",
              "time_ranges",
              "evidence",
              "confidence"
            ],
            "properties": {
              "name": {
                "type": "string"
              },
              "type": {
                "type": "string"
              },
              "category": {
                "type": "string"
              },
              "time_ranges": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  },
                  "minItems": 2,
                  "maxItems": 2
                }
              },
              "evidence": {
                "type": "object",
                "required": [
                  "ocr",
                  "asr",
                  "visual"
                ],
                "properties": {
                  "ocr": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "asr": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "visual": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              },
              "confidence": {
                "type": "string",
                "enum": [
                  "low",
                  "medium",
                  "high"
                ]
              }
            }
          }
        },
        "scenes": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "scene_id",
              "start_time",
              "end_time",
              "narrative_unit",
              "shots",
              "visual_style",
              "audio_style"
            ],
            "properties": {
              "scene_id": {
                "type": "string"
              },
              "start_time": {
                "type": "number",
                "minimum": 0
              },
              "end_time": {
                "type": "number",
                "minimum": 0
              },
              "narrative_unit": {
                "type": "object",
                "required": [
                  "narrative_role",
                  "summary",
                  "rhetoric"
                ],
                "properties": {
                  "narrative_role": {
                    "type": "string"
                  },
                  "summary": {
                    "type": "string"
                  },
                  "rhetoric": {
                    "type": "string"
                  }
                }
              },
              "shots": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "shot_id",
                    "camera",
                    "keyframes"
                  ],
                  "properties": {
                    "shot_id": {
                      "type": "string"
                    },
                    "camera": {
                      "type": "object",
                      "required": [
                        "angle",
                        "movement",
                        "shot_type"
                      ],
                      "properties": {
                        "angle": {
                          "type": "string"
                        },
                        "movement": {
                          "type": "string"
                        },
                        "shot_type": {
                          "type": "string"
                        }
                      }
                    },
                    "keyframes": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "required": [
                          "description",
                          "role",
                          "t_rel_shot"
                        ],
                        "properties": {
                          "description": {
                            "type": "string"
                          },
                          "role": {
                            "type": "string"
                          },
                          "t_rel_shot": {
                            "type": "number",
                            "minimum": 0
                          }
                        }
                      }
                    }
                  }
                }
              },
              "visual_style": {
                "type": "object",
                "required": [
                  "lighting",
                  "mood_palette",
                  "composition"
                ],
                "properties": {
                  "lighting": {
                    "type": "string"
                  },
                  "mood_palette": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "composition": {
                    "type": "object",
                    "required": [
                      "grid_structure",
                      "notes"
                    ],
                    "properties": {
                      "grid_structure": {
                        "type": "string"
                      },
                      "notes": {
                        "type": "string"
                      }
                    }
                  }
                }
              },
              "audio_style": {
                "type": "object",
                "required": [
                  "music",
                  "tone",
                  "ambient_sound"
                ],
                "properties": {
                  "music": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "ambient_sound": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "service_mentions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "type",
              "category",
              "time_ranges",
              "evidence",
              "confidence"
            ],
            "properties": {
              "name": {
                "type": "string"
              },
              "type": {
                "type": "string"
              },
              "category": {
                "type": "string"
              },
              "time_ranges": {
                "type": "array",
                "items": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  },
                  "minItems": 2,
                  "maxItems": 2
                }
              },
              "evidence": {
                "type": "object",
                "required": [
                  "ocr",
                  "asr",
                  "visual"
                ],
                "properties": {
                  "ocr": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "asr": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "visual": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              },
              "confidence": {
                "type": "string",
                "enum": [
                  "low",
                  "medium",
                  "high"
                ]
              }
            }
          }
        },
        "default_lang": {
          "type": "string",
          "pattern": "^[a-z]{2}$",
          "description": "ISO 639-1 language code"
        }
      }
    }
  },
  "safety_settings": [
    {
      "category": "HARM_CATEGORY_HATE_SPEECH",
      "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
      "category": "HARM_CATEGORY_DANGEROUS_CONTENT",
      "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
      "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT",
      "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
      "category": "HARM_CATEGORY_HARASSMENT",
      "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    }
  ]
}
