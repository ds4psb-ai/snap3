{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "VDP v2.0",
  "type": "object",
  "required": ["content_id","metadata","overall_analysis","scenes"],
  "properties": {
    "content_id": { "type": "string", "minLength": 1 },
    "metadata": {
      "type": "object",
      "required": ["platform","language","source_url"],
      "properties": {
        "platform": { "type": "string", "enum": ["YouTube","Instagram","TikTok","unknown","youtube","instagram","tiktok"] },
        "language": { "type": "string", "minLength": 1 },
        "source_url": { "type": "string", "minLength": 1 },
        "upload_date": { "type": "string" },
        "video_origin": { "type": "string" },
        "hashtags": { "type": "array", "items": { "type": "string" } },
        "original_sound": {
          "type": "object",
          "properties": { "id":{"type":"string"}, "title":{"type":"string"} }
        },
        "engagement_snapshot": {
          "type": "object",
          "properties": {
            "view_count":{"type":"number"}, "like_count":{"type":"number"},
            "comment_count":{"type":"number"}, "share_count":{"type":"number"}
          }
        }
      }
    },
    "overall_analysis": {
      "type": "object",
      "required": ["hookGenome"],
      "properties": {
        "duration_sec": { "type": "number" },
        "aspect_ratio": { "type": "string" },
        "story_telling": {
          "type": "object",
          "properties": {
            "has_story": { "type": "boolean" },
            "plot": {
              "type": "object",
              "properties": {
                "conflict": {"type":"string"},
                "action_taken": {"type":"string"},
                "resolution": {"type":"string"}
              }
            }
          }
        },
        "hookGenome": {
          "type": "object",
          "required": ["start_sec","strength_score","pattern_code"],
          "properties": {
            "start_sec": { "type": "number", "maximum": 3.0 },
            "end_sec":   { "type": "number" },
            "strength_score": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
            "pattern_code": {
              "oneOf": [
                { "type":"string" },
                { "type":"array", "items":{"type":"string"}, "minItems":1 }
              ]
            },
            "delivery": { "type":"string" },
            "trigger_modalities": { "type":"array", "items":{"type":"string"} },
            "microbeats_sec": { "type":"array", "items":{"type":"number"} }
          }
        }
      }
    },
    "scenes": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["start_sec","end_sec","narrative_role"],
        "properties": {
          "start_sec": { "type": "number" },
          "end_sec": { "type": "number" },
          "narrative_role": { "type": "string" },
          "transcript": { "type": "string" },
          "on_screen_text": { "type": "array", "items": {"type":"string"} },
          "visual_summary": { "type": "string" },
          "camera": {
            "type": "object",
            "properties": { "shot_type":{"type":"string"}, "movement":{"type":"string"} }
          },
          "audio": {
            "type": "object",
            "properties": { "music":{"type":"string"}, "sfx":{"type":"string"} }
          },
          "tags": { "type":"array", "items":{"type":"string"} }
        }
      }
    },
    "technical": {
      "type": "object",
      "properties": { "fps":{"type":"number"}, "resolution":{"type":"string"} }
    }
  }
}