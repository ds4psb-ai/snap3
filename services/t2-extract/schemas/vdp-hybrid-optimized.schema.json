{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "VDP-Hybrid-Optimized v1.0",
  "description": "Token-efficient VDP schema eliminating redundant scene/shot/keyframe descriptions",
  "type": "object",
  "required": ["content_id", "media", "hook_genome", "scenes", "context"],
  "additionalProperties": false,
  "properties": {
    "content_id": {
      "type": "string",
      "pattern": "^[A-Z0-9_]{1,12}$"
    },
    "media": {
      "type": "object",
      "required": ["platform", "duration_sec", "source_url"],
      "properties": {
        "platform": {
          "type": "string", 
          "enum": ["YouTube", "Instagram", "TikTok"]
        },
        "duration_sec": {
          "type": "number",
          "minimum": 1,
          "maximum": 300
        },
        "source_url": {"type": "string"},
        "view_count": {"type": "integer", "minimum": 0},
        "like_count": {"type": "integer", "minimum": 0},
        "comment_count": {"type": "integer", "minimum": 0}
      }
    },
    "hook_genome": {
      "type": "object",
      "required": ["pattern_code", "strength_score", "start_sec", "end_sec"],
      "properties": {
        "pattern_code": {
          "oneOf": [
            {"type": "string"},
            {"type": "array", "items": {"type": "string"}, "maxItems": 3}
          ]
        },
        "strength_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "start_sec": {"type": "number", "minimum": 0},
        "end_sec": {"type": "number", "maximum": 3},
        "delivery": {"type": "string", "maxLength": 100},
        "trigger_modalities": {
          "type": "array",
          "items": {"type": "string", "enum": ["visual", "audio", "text"]},
          "maxItems": 3
        }
      }
    },
    "scenes": {
      "type": "array",
      "minItems": 1,
      "maxItems": 8,
      "items": {
        "type": "object",
        "required": ["idx", "start", "end", "beat", "role", "shots"],
        "properties": {
          "idx": {"type": "integer", "minimum": 0},
          "start": {"type": "number", "minimum": 0},
          "end": {"type": "number"},
          "beat": {
            "type": "string",
            "maxLength": 80,
            "description": "Single concise narrative beat - NO REDUNDANT DESCRIPTIONS"
          },
          "role": {
            "type": "string",
            "enum": ["Hook", "Build", "Peak", "Resolve", "CTA"]
          },
          "shots": {
            "type": "array",
            "minItems": 1,
            "maxItems": 6,
            "items": {
              "type": "object",
              "required": ["idx", "cam", "comp", "kf"],
              "properties": {
                "idx": {"type": "integer"},
                "cam": {
                  "type": "object",
                  "required": ["size", "angle", "move"],
                  "properties": {
                    "size": {
                      "type": "string",
                      "enum": ["ECU", "CU", "MCU", "MS", "MLS", "WS", "EWS"]
                    },
                    "angle": {
                      "type": "string",
                      "enum": ["eye", "high", "low", "overhead", "dutch"]
                    },
                    "move": {
                      "type": "string",
                      "enum": ["static", "pan", "tilt", "dolly", "truck", "handheld", "crane", "zoom"]
                    }
                  }
                },
                "comp": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["left_third", "center", "right_third", "symmetry"]
                  },
                  "maxItems": 2,
                  "description": "Composition rules - SYMBOLS ONLY, no verbose descriptions"
                },
                "kf": {
                  "type": "array",
                  "minItems": 2,
                  "maxItems": 4,
                  "items": {
                    "type": "object",
                    "required": ["t", "desc"],
                    "properties": {
                      "t": {"type": "number"},
                      "desc": {
                        "type": "string",
                        "maxLength": 40,
                        "description": "Ultra-concise keyframe description - NO REPETITION of scene/shot context"
                      }
                    }
                  }
                },
                "audio": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["t", "event", "intensity"],
                    "properties": {
                      "t": {"type": "number"},
                      "event": {
                        "type": "string",
                        "enum": ["music_starts", "music_stops", "sfx", "laugh", "voice_peak", "silence"]
                      },
                      "intensity": {"type": "integer", "minimum": 1, "maximum": 3}
                    }
                  },
                  "maxItems": 3
                }
              }
            }
          }
        }
      }
    },
    "context": {
      "type": "object",
      "description": "Single context object to eliminate redundancy across scenes",
      "properties": {
        "overall_summary": {
          "type": "string",
          "maxLength": 200,
          "description": "ONE comprehensive summary replacing all individual scene summaries"
        },
        "emotional_arc": {
          "type": "string",
          "maxLength": 150
        },
        "visual_style": {
          "type": "object",
          "properties": {
            "lighting": {"type": "string", "maxLength": 50},
            "mood": {
              "type": "array",
              "items": {"type": "string"},
              "maxItems": 4
            },
            "edit_pace": {"type": "string", "enum": ["slow", "medium", "fast", "mixed"]}
          }
        },
        "audio_profile": {
          "type": "object",
          "properties": {
            "music_type": {"type": "string", "maxLength": 40},
            "tone": {"type": "string", "maxLength": 40}
          }
        },
        "transcript": {
          "type": "object",
          "properties": {
            "lang": {"type": "string", "pattern": "^[a-z]{2}$"},
            "text": {"type": "string", "maxLength": 500},
            "translation_en": {"type": "string", "maxLength": 500}
          }
        }
      }
    },
    "mentions": {
      "type": "object",
      "properties": {
        "products": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "time_range"],
            "properties": {
              "name": {"type": "string", "maxLength": 50},
              "time_range": {
                "type": "array",
                "items": {"type": "number"},
                "minItems": 2,
                "maxItems": 2
              },
              "confidence": {"type": "string", "enum": ["low", "medium", "high"]}
            }
          }
        },
        "services": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "time_range"],
            "properties": {
              "name": {"type": "string", "maxLength": 50},
              "time_range": {
                "type": "array",
                "items": {"type": "number"},
                "minItems": 2,
                "maxItems": 2
              },
              "confidence": {"type": "string", "enum": ["low", "medium", "high"]}
            }
          }
        }
      }
    }
  }
}